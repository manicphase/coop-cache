<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
  
  <script src="sha1.js">/* SHA-256 JavaScript implementation */</script>
  
  <script type="text/javascript">
	function hashops() {
		messagehash = Sha1.hash(mess.message.value);
		messagerehash = Sha1.hash(mess.message.value);
		mess.mhash.value = messagehash;
		mess.mrehash.value = Sha1.hash(messagehash);

		passwordhash = Sha1.hash(login.password.value);
		userhash = Sha1.hash(login.username.value);
		mess.userid.value = userhash;
		mess.passhash.value = passwordhash;

		xs = messagehash + passwordhash;		
		xsolution = Sha1.hash(xs);
		xchallenge = Sha1.hash(xsolution);
		mess.solution.value = xsolution;
		mess.challenge.value = xchallenge;

		postdata = 'challenge='+xchallenge+'&userid='+userhash+'&messagehash='+messagehash+'&messagedata='+mess.message.value;

		mess.pc.value = postdata;

	}
	</script>
</head><body>
<form name="login">
  <fieldset> <legend>Enter login details</legend> <label for="login">Username</label><input name="username" id="username">
<label for="login">Password</label><input name="password" id="password">
</fieldset>
</form>

<form name="mess">
  <fieldset> <legend>Message hash testing page</legend> <label for="message">Enter message</label><br>
  <textarea name="message" id="message">abc</textarea>
  <ul>
    <li> <button type="button" onclick="hashops()">Generate hashes</button>
    </li>
	<li> <label for="message">Userid</label> <input name="userid" id="userid" readonly="readonly" type="text"> </li>
	<li> <label for="message">Password hash</label> <input name="passhash" id="passhash" readonly="readonly" type="text"> </li>
	<br>
    <li> <label for="message">Message hash</label> <input name="mhash" id="mhash" readonly="readonly" type="text"> </li>
    <li> <label for="message">Rehashed message hash</label> <input name="mrehash" id="mrehash" readonly="readonly" type="text"> </li>
	<br>
	<li> <label for="message">Solution(passhash x messagehash)</label> <input name="solution" id="solution" readonly="readonly" type="text"> </li>
	<li> <label for="message">Challenge(hashed solution)</label> <input name="challenge" id="challenge" readonly="readonly" type="text"> </li>
	<br>
	<li> <form method="post" enctype="multipart/form-data" action="/">Post a
		message to wall<input name="postcontent[]" id="pc" type="text" width="100%"><input value="Press" type="submit"> post message!
	</form> </li>
  </ul>
  </fieldset>
</form>

</body></html>
